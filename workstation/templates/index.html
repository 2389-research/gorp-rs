{% extends "base.html" %}

{% block title %}Workstation - Dashboard{% endblock %}

{% block nav %}
{% match user %}
{% when Some with (u) %}
<span class="text-gray-400">{{ u }}</span>
<a href="/auth/logout" class="text-red-400 hover:text-red-300">Logout</a>
{% when None %}
<a href="/auth/login" class="bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded">Login with Matrix</a>
{% endmatch %}
{% endblock %}

{% block content %}
<div class="space-y-6">
    <h1 class="text-2xl font-bold">Welcome to Workstation</h1>
    <p class="text-gray-400">Configure your gorp workspaces.</p>

    {% match error %}
    {% when Some with (e) %}
    <div class="bg-red-900 border border-red-700 rounded p-4 text-red-200">
        {{ e }}
    </div>
    {% when None %}
    {% endmatch %}

    {% match user %}
    {% when Some with (_u) %}
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h2 class="text-lg font-semibold mb-4">Your Channels</h2>
        {% if channels.is_empty() %}
        <p class="text-gray-500">No channels found. Create one in Matrix with !create &lt;name&gt;</p>
        {% else %}
        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
            {% for channel in channels %}
            <a href="/files/{{ channel.channel_name }}/"
               class="block bg-gray-700 hover:bg-gray-600 rounded-lg p-4 transition">
                <h3 class="font-medium text-blue-400">{{ channel.channel_name }}</h3>
                <p class="text-sm text-gray-400 mt-1">Created: {{ channel.created_at }}</p>
            </a>
            {% endfor %}
        </div>
        {% endif %}
    </div>

    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h2 class="text-lg font-semibold mb-4">Tools</h2>
        <div class="flex gap-4">
            <a href="/terminal" class="bg-green-600 hover:bg-green-500 px-4 py-2 rounded">
                Terminal
            </a>
            <a href="/browser" class="bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded">
                Browser Viewer
            </a>
        </div>
    </div>
    {% when None %}
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h2 class="text-lg font-semibold mb-4">Get Started</h2>
        <p class="text-gray-500">Login with your Matrix account to see your channels.</p>
    </div>
    {% endmatch %}
</div>
{% endblock %}

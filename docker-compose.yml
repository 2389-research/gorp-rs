# ABOUTME: Docker Compose configuration for gorp Matrix-Claude bridge
# ABOUTME: Uses XDG-compliant paths with volume mounts for config and data persistence
version: '3.8'

services:
  gorp:
    build: .
    image: gorp:latest
    container_name: gorp
    restart: unless-stopped

    # Environment variables (override config.toml values)
    # Use env_file OR environment, not both for the same vars
    env_file:
      - .env

    # Persistent volumes using XDG directory structure
    volumes:
      # Config directory - put your config.toml here
      - ./config:/home/gorp/.config/gorp

      # Data directory (crypto store, logs, scheduled prompts db)
      - ./data:/home/gorp/.local/share/gorp

      # Workspace directory for Claude sessions
      - ./workspace:/home/gorp/workspace

    # Webhook port
    ports:
      - "13000:13000"

    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
